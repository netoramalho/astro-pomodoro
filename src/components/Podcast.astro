---
import CircleBlur from "./CircleBlur.astro";
const { rank, title, text, spotify, color, position } = Astro.props;
const response = await fetch(`https://open.spotify.com/oembed?url=https://open.spotify.com/show/${spotify}`)
const data = await response.json()
---

<div class="podcast">
    <CircleBlur class={`podcast__circle--${position}`} color={color} />
    <a href={`https://open.spotify.com/show/${spotify}`} target="_blank" class="podcast__player">
        <img
            class="podcast__player-thumbnail"
            src={data.thumbnail_url}
            alt="Podcast Thumbnail"
            width={data.thumbnail_width}
            height={data.thumbnail_height}
        >
        <div class="podcast__player-fade" />
        <svg
            role="img"
            height="24"
            width="24"
            aria-hidden="false"
            class="podcast__player-play"
            viewBox="0 0 24 24"
            data-encore-id="icon"
        >
            <title>Play</title>
            <path d="M1 12C1 5.925 5.925 1 12 1s11 4.925 11 11-4.925 11-11 11S1 18.075 1 12zm8.75-4.567a.5.5 0 0 0-.75.433v8.268a.5.5 0 0 0 .75.433l7.161-4.134a.5.5 0 0 0 0-.866L9.75 7.433z"></path>
        </svg>
    </a>
    <div class="wrap">
        <h2 class="podcast__title">{rank}. {title}</h2>
        <p class="podcast__text">{text}</p>
    </div>
</div>

<style lang="scss">
    .podcast {
        display: flex;
        align-items: center;
        gap: 25px;
        margin-top: 60px;
        transition: transform 0.3s ease-in-out;

        &:hover {
            transform: scale(1.02);
        }

        @media (max-width: 700px) {
            flex-direction: column;
            align-items: flex-start;
        }

        &__circle--left {
            left: -65%;
            opacity: 0.7;
            transition: transform 0.3s ease-in-out;
        }

        &__circle--right {
            left: 65%;
            opacity: 0.7;
        }

        &__title {
            font-weight: 500;
            font-size: 30px;
            line-height: 145%;
            color: #E1E1E1;
            margin-bottom: 10px;
            margin-top: 0;

            @media (max-width: 600px) {
                font-size: 24px;
            }
        }

        &__text {
            font-weight: 300;
            font-size: 18px;
            line-height: 145%;
            color: #D9D9D9;
            margin-bottom: 0;

            @media (max-width: 600px) {
                font-size: 16px;
            }
        }

        &__player {
            position: relative;
            max-width: 140px;
            padding: 14px;
            height: fit-content;
        }

        &__player-thumbnail {
            border-radius: 8px;
            width: 140px;
            height: 140px;
            box-shadow: 0 9px 9px 0 rgba(0,0,0,.1), 0 0 29px 0 rgba(0,0,0,.1);
        }

        &__player-fade {
            position: absolute;
            inset: 0;
            background: rgb(0 0 0 / 40%);
            border-radius: 15px;
        }

        &__player-play {
            position: absolute;
            z-index: 1;
            inset: 0;
            margin: auto;
            cursor: pointer;
            fill: white;
            height: 50px;
            width: 50px;
            transition: transform 0.2s ease-in-out;
        }

        &__player:hover .podcast__player-play {
            transform: scale(1.1);
        }

        &__spotify {
            border: 0px;
            border-radius: 12px
        }
    }
</style>